<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Análisis Estadístico - Comportamiento Proambiental</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root {
            --primary-color: #2e7d32;
            --secondary-color: #4caf50;
            --accent-color: #8bc34a;
            --light-color: #e8f5e9;
            --dark-color: #1b5e20;
            --text-color: #333;
            --light-text: #fff;
        }
        
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
        }
        
        body {
            background-color: #f5f5f5;
            color: var(--text-color);
            line-height: 1.6;
        }
        
        header {
            background-color: var(--primary-color);
            color: var(--light-text);
            padding: 1.5rem;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.1);
        }
        
        h1 {
            font-size: 2rem;
            margin-bottom: 0.5rem;
        }
        
        .subtitle {
            font-size: 1.2rem;
            opacity: 0.9;
        }
        
        .container {
            max-width: 1200px;
            margin: 0 auto;
            padding: 1.5rem;
        }
        
        .section {
            background-color: white;
            border-radius: 8px;
            padding: 1.5rem;
            margin-bottom: 2rem;
            box-shadow: 0 2px 10px rgba(0,0,0,0.05);
        }
        
        .section-title {
            color: var(--dark-color);
            border-bottom: 2px solid var(--accent-color);
            padding-bottom: 0.5rem;
            margin-bottom: 1.5rem;
            font-size: 1.5rem;
        }
        
        .charts-container {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(300px, 1fr));
            gap: 1.5rem;
            margin-top: 1.5rem;
        }
        
        .chart-card {
            background-color: var(--light-color);
            border-radius: 8px;
            padding: 1rem;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .chart-title {
            font-size: 1.1rem;
            margin-bottom: 1rem;
            text-align: center;
            color: var(--dark-color);
        }
        
        .chart-container {
            position: relative;
            height: 250px;
        }
        
        .stats-summary {
            display: grid;
            grid-template-columns: repeat(auto-fit, minmax(200px, 1fr));
            gap: 1rem;
            margin-top: 1.5rem;
        }
        
        .stat-card {
            background-color: var(--light-color);
            border-radius: 8px;
            padding: 1rem;
            text-align: center;
            box-shadow: 0 2px 5px rgba(0,0,0,0.05);
        }
        
        .stat-value {
            font-size: 2rem;
            font-weight: bold;
            color: var(--primary-color);
        }
        
        .stat-label {
            font-size: 0.9rem;
            color: var(--text-color);
            margin-top: 0.5rem;
        }
        
        .loading {
            text-align: center;
            padding: 2rem;
            font-size: 1.2rem;
            color: var(--primary-color);
        }
        
        .error {
            text-align: center;
            padding: 2rem;
            font-size: 1.2rem;
            color: #d32f2f;
            background-color: #ffebee;
            border-radius: 8px;
            margin-bottom: 2rem;
        }
        
        footer {
            text-align: center;
            padding: 1.5rem;
            background-color: var(--dark-color);
            color: var(--light-text);
            margin-top: 2rem;
        }
        
        @media (max-width: 768px) {
            .charts-container {
                grid-template-columns: 1fr;
            }
            
            .stats-summary {
                grid-template-columns: repeat(2, 1fr);
            }
        }
    </style>
</head>
<body>
    <header>
        <h1>Análisis Estadístico</h1>
        <div class="subtitle">Comportamiento Proambiental y Autosustentabilidad</div>
    </header>
    
    <div class="container">
        <div id="loading" class="loading">
            Cargando datos...
        </div>
        
        <div id="error" class="error" style="display: none;">
            Error al cargar los datos
        </div>
        
        <div id="content" style="display: none;">
            <!-- Resumen General -->
            <section class="section">
                <h2 class="section-title">Resumen General</h2>
                <div class="stats-summary">
                    <div class="stat-card">
                        <div class="stat-value" id="total-encuestas">0</div>
                        <div class="stat-label">Total de Encuestas</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="promedio-edad">0</div>
                        <div class="stat-label">Edad Promedio</div>
                    </div>
                    <div class="stat-card">
                        <div class="stat-value" id="promedio-integrantes">0</div>
                        <div class="stat-label">Integrantes por Familia</div>
                    </div>
                </div>
            </section>
            
            <!-- Distribución por Edad -->
            <section class="section">
                <h2 class="section-title">Distribución por Edad</h2>
                <div class="charts-container">
                    <div class="chart-card">
                        <div class="chart-title">Rangos de Edad</div>
                        <div class="chart-container">
                            <canvas id="edadChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Integrantes por Rango de Edad</div>
                        <div class="chart-container">
                            <canvas id="integrantesEdadChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Características del Hogar -->
            <section class="section">
                <h2 class="section-title">Características del Hogar</h2>
                <div class="charts-container">
                    <div class="chart-card">
                        <div class="chart-title">Nivel de Educación del Jefe de Hogar</div>
                        <div class="chart-container">
                            <canvas id="educacionChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Situación Laboral del Jefe de Hogar</div>
                        <div class="chart-container">
                            <canvas id="laboralChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Ingreso Mensual del Jefe de Hogar</div>
                        <div class="chart-container">
                            <canvas id="ingresoChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Tipo de Hogar</div>
                        <div class="chart-container">
                            <canvas id="hogarChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Determinantes Socioculturales -->
            <section class="section">
                <h2 class="section-title">Determinantes Socioculturales</h2>
                <div class="charts-container">
                    <div class="chart-card">
                        <div class="chart-title">Conocimiento sobre Desechos Sólidos</div>
                        <div class="chart-container">
                            <canvas id="conoceDesechosChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Comportamiento Adecuado en la Comunidad</div>
                        <div class="chart-container">
                            <canvas id="comportamientoAdecuadoChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Determinantes Afectivos -->
            <section class="section">
                <h2 class="section-title">Determinantes Afectivos</h2>
                <div class="charts-container">
                    <div class="chart-card">
                        <div class="chart-title">Preocupación por Exceso de Desechos</div>
                        <div class="chart-container">
                            <canvas id="preocupaDesechosChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Importancia del Planeta para Futuras Generaciones</div>
                        <div class="chart-container">
                            <canvas id="planetaFuturasGeneracionesChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Sustentabilidad Ambiental -->
            <section class="section">
                <h2 class="section-title">Sustentabilidad Ambiental</h2>
                <div class="charts-container">
                    <div class="chart-card">
                        <div class="chart-title">Funcionalidad de Desechos Orgánicos</div>
                        <div class="chart-container">
                            <canvas id="desechosOrganicosFuncionalidadChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Impacto de Reducción, Reciclaje y Reutilización</div>
                        <div class="chart-container">
                            <canvas id="reduccionReciclajeChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Sustentabilidad Económica -->
            <section class="section">
                <h2 class="section-title">Sustentabilidad Económica</h2>
                <div class="charts-container">
                    <div class="chart-card">
                        <div class="chart-title">Práctica de Separación para Reciclaje con Ingreso</div>
                        <div class="chart-container">
                            <canvas id="separacionReciclajeIngresoChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Oportunidades de Emprendimiento</div>
                        <div class="chart-container">
                            <canvas id="oportunidadEmprendimientoChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>
            
            <!-- Desarrollo Comunitario -->
            <section class="section">
                <h2 class="section-title">Desarrollo Comunitario</h2>
                <div class="charts-container">
                    <div class="chart-card">
                        <div class="chart-title">Participación en Talleres</div>
                        <div class="chart-container">
                            <canvas id="participacionTalleresChart"></canvas>
                        </div>
                    </div>
                    <div class="chart-card">
                        <div class="chart-title">Disposición a Participar en Emprendimientos</div>
                        <div class="chart-container">
                            <canvas id="participacionEmprendimientosChart"></canvas>
                        </div>
                    </div>
                </div>
            </section>
        </div>
    </div>
    
    <footer>
        <p>Análisis Estadístico - Comportamiento Proambiental y Autosustentabilidad</p>
    </footer>

    <script>
        // Configuración de Supabase
        const supabaseUrl = 'https://dutapywxsiuxboqsjqvf.supabase.co';
        const supabaseKey = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6ImR1dGFweXd4c2l1eGJvcXNqcXZmIiwicm9sZSI6ImFub24iLCJpYXQiOjE3NTM3MTk1MTUsImV4cCI6MjA2OTI5NTUxNX0.SBIDeV_WAWlyLs-ROD1ibXtqqY5bbbh0gouYgRB9Y4';
        const supabase = supabase.createClient(supabaseUrl, supabaseKey);
        
        // Variables globales para almacenar datos
        let encuestas = [];
        let charts = {};
        
        // Función para cargar datos desde Supabase
        async function cargarDatos() {
            try {
                const { data, error } = await supabase
                    .from('cuestionario_comportamiento_proambiental_autosustentabilidad')
                    .select('*');
                    
                if (error) {
                    throw error;
                }
                
                encuestas = data;
                mostrarDatos();
            } catch (error) {
                console.error('Error al cargar datos:', error);
                document.getElementById('loading').style.display = 'none';
                document.getElementById('error').style.display = 'block';
            }
        }
        
        // Función para mostrar los datos en la página
        function mostrarDatos() {
            document.getElementById('loading').style.display = 'none';
            document.getElementById('content').style.display = 'block';
            
            // Actualizar resumen general
            actualizarResumenGeneral();
            
            // Crear gráficos
            crearGraficos();
        }
        
        // Función para actualizar el resumen general
        function actualizarResumenGeneral() {
            const totalEncuestas = encuestas.length;
            const promedioEdad = totalEncuestas > 0 
                ? Math.round(encuestas.reduce((sum, e) => sum + (e.edad || 0), 0) / totalEncuestas)
                : 0;
            const promedioIntegrantes = totalEncuestas > 0
                ? Math.round(encuestas.reduce((sum, e) => sum + (e.num_integrantes_familia || 0), 0) / totalEncuestas * 10) / 10
                : 0;
                
            document.getElementById('total-encuestas').textContent = totalEncuestas;
            document.getElementById('promedio-edad').textContent = promedioEdad;
            document.getElementById('promedio-integrantes').textContent = promedioIntegrantes;
        }
        
        // Función para crear todos los gráficos
        function crearGraficos() {
            // Gráfico de distribución por edad
            crearGraficoEdad();
            
            // Gráfico de integrantes por rango de edad
            crearGraficoIntegrantesEdad();
            
            // Gráficos de características del hogar
            crearGraficoEducacion();
            crearGraficoSituacionLaboral();
            crearGraficoIngreso();
            crearGraficoTipoHogar();
            
            // Gráficos de determinantes socioculturales
            crearGraficoConoceDesechos();
            crearGraficoComportamientoAdecuado();
            
            // Gráficos de determinantes afectivos
            crearGraficoPreocupaDesechos();
            crearGraficoPlanetaFuturasGeneraciones();
            
            // Gráficos de sustentabilidad ambiental
            crearGraficoDesechosOrganicosFuncionalidad();
            crearGraficoReduccionReciclaje();
            
            // Gráficos de sustentabilidad económica
            crearGraficoSeparacionReciclajeIngreso();
            crearGraficoOportunidadEmprendimiento();
            
            // Gráficos de desarrollo comunitario
            crearGraficoParticipacionTalleres();
            crearGraficoParticipacionEmprendimientos();
        }
        
        // Función auxiliar para contar respuestas por categoría
        function contarRespuestas(campo, categorias) {
            const conteo = {};
            categorias.forEach(cat => { conteo[cat] = 0; });
            
            encuestas.forEach(encuesta => {
                const valor = encuesta[campo];
                if (valor && categorias.includes(valor)) {
                    conteo[valor]++;
                }
            });
            
            return conteo;
        }
        
        // Función auxiliar para calcular porcentajes
        function calcularPorcentajes(conteo, total) {
            const porcentajes = {};
            Object.keys(conteo).forEach(key => {
                porcentajes[key] = total > 0 ? Math.round((conteo[key] / total) * 100) : 0;
            });
            return porcentajes;
        }
        
        // Función para crear gráfico de distribución por edad
        function crearGraficoEdad() {
            const rangos = ['0-10', '11-25', '26-50', '51-90'];
            const datos = rangos.map(rango => {
                return encuestas.filter(e => {
                    const edad = e.edad;
                    if (!edad) return false;
                    
                    if (rango === '0-10') return edad >= 0 && edad <= 10;
                    if (rango === '11-25') return edad >= 11 && edad <= 25;
                    if (rango === '26-50') return edad >= 26 && edad <= 50;
                    if (rango === '51-90') return edad >= 51 && edad <= 90;
                    return false;
                }).length;
            });
            
            const ctx = document.getElementById('edadChart').getContext('2d');
            charts.edadChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: rangos,
                    datasets: [{
                        label: 'Cantidad de Personas',
                        data: datos,
                        backgroundColor: [
                            'rgba(76, 175, 80, 0.7)',
                            'rgba(139, 195, 74, 0.7)',
                            'rgba(205, 220, 57, 0.7)',
                            'rgba(255, 193, 7, 0.7)'
                        ],
                        borderColor: [
                            'rgba(76, 175, 80, 1)',
                            'rgba(139, 195, 74, 1)',
                            'rgba(205, 220, 57, 1)',
                            'rgba(255, 193, 7, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const total = datos.reduce((a, b) => a + b, 0);
                                    const porcentaje = total > 0 ? Math.round((context.raw / total) * 100) : 0;
                                    return `${context.raw} personas (${porcentaje}%)`;
                                }
                            }
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Cantidad'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Rango de Edad'
                            }
                        }
                    }
                }
            });
        }
        
        // Función para crear gráfico de integrantes por rango de edad
        function crearGraficoIntegrantesEdad() {
            const rangos = ['0-10 años', '11-25 años', '26-50 años', '51-90 años'];
            const campos = ['edad_0_10', 'edad_11_25', 'edad_26_50', 'edad_51_90'];
            
            const datos = campos.map(campo => {
                return encuestas.reduce((sum, e) => sum + (e[campo] || 0), 0);
            });
            
            const ctx = document.getElementById('integrantesEdadChart').getContext('2d');
            charts.integrantesEdadChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: rangos,
                    datasets: [{
                        data: datos,
                        backgroundColor: [
                            'rgba(76, 175, 80, 0.7)',
                            'rgba(139, 195, 74, 0.7)',
                            'rgba(205, 220, 57, 0.7)',
                            'rgba(255, 193, 7, 0.7)'
                        ],
                        borderColor: [
                            'rgba(76, 175, 80, 1)',
                            'rgba(139, 195, 74, 1)',
                            'rgba(205, 220, 57, 1)',
                            'rgba(255, 193, 7, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        },
                        tooltip: {
                            callbacks: {
                                label: function(context) {
                                    const total = datos.reduce((a, b) => a + b, 0);
                                    const porcentaje = total > 0 ? Math.round((context.raw / total) * 100) : 0;
                                    return `${context.label}: ${context.raw} personas (${porcentaje}%)`;
                                }
                            }
                        }
                    }
                }
            });
        }
        
        // Función para crear gráfico de nivel de educación
        function crearGraficoEducacion() {
            const categorias = ['Primaria', 'Secundaria', 'Universidad', 'Postgrado'];
            const conteo = contarRespuestas('educacion_jefe_hogar', categorias);
            const porcentajes = calcularPorcentajes(conteo, encuestas.length);
            
            const ctx = document.getElementById('educacionChart').getContext('2d');
            charts.educacionChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: categorias.map((cat, i) => `${cat} (${porcentajes[cat]}%)`),
                    datasets: [{
                        data: Object.values(conteo),
                        backgroundColor: [
                            'rgba(76, 175, 80, 0.7)',
                            'rgba(139, 195, 74, 0.7)',
                            'rgba(205, 220, 57, 0.7)',
                            'rgba(255, 193, 7, 0.7)'
                        ],
                        borderColor: [
                            'rgba(76, 175, 80, 1)',
                            'rgba(139, 195, 74, 1)',
                            'rgba(205, 220, 57, 1)',
                            'rgba(255, 193, 7, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }
        
        // Función para crear gráfico de situación laboral
        function crearGraficoSituacionLaboral() {
            const categorias = ['Desempleado', 'Trabajo Temporal', 'Empleado'];
            const conteo = contarRespuestas('situacion_laboral_jefe_hogar', categorias);
            const porcentajes = calcularPorcentajes(conteo, encuestas.length);
            
            const ctx = document.getElementById('laboralChart').getContext('2d');
            charts.laboralChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: categorias.map((cat, i) => `${cat} (${porcentajes[cat]}%)`),
                    datasets: [{
                        data: Object.values(conteo),
                        backgroundColor: [
                            'rgba(76, 175, 80, 0.7)',
                            'rgba(139, 195, 74, 0.7)',
                            'rgba(205, 220, 57, 0.7)'
                        ],
                        borderColor: [
                            'rgba(76, 175, 80, 1)',
                            'rgba(139, 195, 74, 1)',
                            'rgba(205, 220, 57, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }
        
        // Función para crear gráfico de ingreso mensual
        function crearGraficoIngreso() {
            const categorias = ['Menor al sueldo básico', 'Sueldo básico', 'Mayor al sueldo básico'];
            const conteo = contarRespuestas('ingreso_mensual_jefe_hogar', categorias);
            const porcentajes = calcularPorcentajes(conteo, encuestas.length);
            
            const ctx = document.getElementById('ingresoChart').getContext('2d');
            charts.ingresoChart = new Chart(ctx, {
                type: 'doughnut',
                data: {
                    labels: categorias.map((cat, i) => `${cat} (${porcentajes[cat]}%)`),
                    datasets: [{
                        data: Object.values(conteo),
                        backgroundColor: [
                            'rgba(76, 175, 80, 0.7)',
                            'rgba(139, 195, 74, 0.7)',
                            'rgba(205, 220, 57, 0.7)'
                        ],
                        borderColor: [
                            'rgba(76, 175, 80, 1)',
                            'rgba(139, 195, 74, 1)',
                            'rgba(205, 220, 57, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }
        
        // Función para crear gráfico de tipo de hogar
        function crearGraficoTipoHogar() {
            const categorias = ['Alquilada', 'Propia', 'Prestada'];
            const conteo = contarRespuestas('tipo_hogar', categorias);
            const porcentajes = calcularPorcentajes(conteo, encuestas.length);
            
            const ctx = document.getElementById('hogarChart').getContext('2d');
            charts.hogarChart = new Chart(ctx, {
                type: 'pie',
                data: {
                    labels: categorias.map((cat, i) => `${cat} (${porcentajes[cat]}%)`),
                    datasets: [{
                        data: Object.values(conteo),
                        backgroundColor: [
                            'rgba(76, 175, 80, 0.7)',
                            'rgba(139, 195, 74, 0.7)',
                            'rgba(205, 220, 57, 0.7)'
                        ],
                        borderColor: [
                            'rgba(76, 175, 80, 1)',
                            'rgba(139, 195, 74, 1)',
                            'rgba(205, 220, 57, 1)'
                        ],
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            position: 'bottom'
                        }
                    }
                }
            });
        }
        
        // Función para crear gráfico de conocimiento sobre desechos sólidos
        function crearGraficoConoceDesechos() {
            const categorias = ['Totalmente desacuerdo', 'Desacuerdo', 'Indiferente', 'De acuerdo', 'Totalmente de acuerdo'];
            const conteo = contarRespuestas('conoce_desechos_solidos', categorias);
            
            const ctx = document.getElementById('conoceDesechosChart').getContext('2d');
            charts.conoceDesechosChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: categorias,
                    datasets: [{
                        label: 'Respuestas',
                        data: Object.values(conteo),
                        backgroundColor: 'rgba(76, 175, 80, 0.7)',
                        borderColor: 'rgba(76, 175, 80, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Cantidad de Respuestas'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Nivel de Acuerdo'
                            }
                        }
                    }
                }
            });
        }
        
        // Función para crear gráfico de comportamiento adecuado en la comunidad
        function crearGraficoComportamientoAdecuado() {
            const categorias = ['Totalmente desacuerdo', 'Desacuerdo', 'Indiferente', 'De acuerdo', 'Totalmente de acuerdo'];
            const conteo = contarRespuestas('cree_comportamiento_adecuado_manejo', categorias);
            
            const ctx = document.getElementById('comportamientoAdecuadoChart').getContext('2d');
            charts.comportamientoAdecuadoChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: categorias,
                    datasets: [{
                        label: 'Respuestas',
                        data: Object.values(conteo),
                        backgroundColor: 'rgba(139, 195, 74, 0.7)',
                        borderColor: 'rgba(139, 195, 74, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Cantidad de Respuestas'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Nivel de Acuerdo'
                            }
                        }
                    }
                }
            });
        }
        
        // Función para crear gráfico de preocupación por exceso de desechos
        function crearGraficoPreocupaDesechos() {
            const categorias = ['Totalmente desacuerdo', 'Desacuerdo', 'Indiferente', 'De acuerdo', 'Totalmente de acuerdo'];
            const conteo = contarRespuestas('preocupa_exceso_desechos', categorias);
            
            const ctx = document.getElementById('preocupaDesechosChart').getContext('2d');
            charts.preocupaDesechosChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: categorias,
                    datasets: [{
                        label: 'Respuestas',
                        data: Object.values(conteo),
                        backgroundColor: 'rgba(205, 220, 57, 0.7)',
                        borderColor: 'rgba(205, 220, 57, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Cantidad de Respuestas'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Nivel de Acuerdo'
                            }
                        }
                    }
                }
            });
        }
        
        // Función para crear gráfico de importancia del planeta para futuras generaciones
        function crearGraficoPlanetaFuturasGeneraciones() {
            const categorias = ['Totalmente desacuerdo', 'Desacuerdo', 'Indiferente', 'De acuerdo', 'Totalmente de acuerdo'];
            const conteo = contarRespuestas('importancia_planeta_futuras_generaciones', categorias);
            
            const ctx = document.getElementById('planetaFuturasGeneracionesChart').getContext('2d');
            charts.planetaFuturasGeneracionesChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: categorias,
                    datasets: [{
                        label: 'Respuestas',
                        data: Object.values(conteo),
                        backgroundColor: 'rgba(255, 193, 7, 0.7)',
                        borderColor: 'rgba(255, 193, 7, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Cantidad de Respuestas'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Nivel de Acuerdo'
                            }
                        }
                    }
                }
            });
        }
        
        // Función para crear gráfico de funcionalidad de desechos orgánicos
        function crearGraficoDesechosOrganicosFuncionalidad() {
            const categorias = ['Totalmente desacuerdo', 'Desacuerdo', 'Indiferente', 'De acuerdo', 'Totalmente de acuerdo'];
            const conteo = contarRespuestas('desechos_organicos_funcionalidad', categorias);
            
            const ctx = document.getElementById('desechosOrganicosFuncionalidadChart').getContext('2d');
            charts.desechosOrganicosFuncionalidadChart = new Chart(ctx, {
                type: 'bar',
                data: {
                    labels: categorias,
                    datasets: [{
                        label: 'Respuestas',
                        data: Object.values(conteo),
                        backgroundColor: 'rgba(76, 175, 80, 0.7)',
                        borderColor: 'rgba(76, 175, 80, 1)',
                        borderWidth: 1
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    plugins: {
                        legend: {
                            display: false
                        }
                    },
                    scales: {
                        y: {
                            beginAtZero: true,
                            title: {
                                display: true,
                                text: 'Cantidad de Respuestas'
                            }
                        },
                        x: {
                            title: {
                                display: true,
                                text: 'Nivel de Acuerdo'
                            }
                        }
                    }
                }
            });
        }
        
        // Función para crear gráfico de impacto de reducción, reciclaje y reutilización
        function crearGraficoReduccionReciclaje() {
            const categorias = ['Totalmente desacuerdo', 'Desacuerdo', 'Indiferente', 'De acuerdo', 'Totalmente de acuerdo'];
            const conteo = contarRespuestas('reduccion_reciclaje_reutilizacion_cuida_ambiente', categorias);
            
            const ctx = document.getElementById('reduccionReciclajeChart').getContext('2d');
            charts.reduccionReciclajeChart = new Chart(ctx, {
                type: '
